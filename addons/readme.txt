Dichotic Harmony Keyboard
Version 1.2 from April, 2010
Copyright (c) 2010 Vadim Madgazin

1. Функции программы и органов управления.

Идея программы состоит в том, чтобы при помощи индивидуального панорамирования
голосов аккорда уменьшать его эффективную диссонантность, т.к. при разведении
голосов любого диссонирующего интервала по разным каналам происходит весьма
значительное уменьшение диссонанса - в упрощенном случае можно считать что он
уменьшается до нуля (хотя это и не совсем так, но для рассчетов суммарного
диссонанса аккорда используется данное приближение).

Программа принимает поток midi сообщений из устройства "MIDI Input Device"
и обрабатывает сообщения о нажатии и отпускании нотных клавиш этого внешнего
источника так, что скорость нажатия всех клавиш становится одинаковой.

Обработанный входной midi поток складывается с midi потоком от внутреннего
генератора аккордов, и если суммарное количество голосов аккорда от обоих
источников превысит значение регулятора "Max num voices", то соответствующая
часть голосов будет проигнорирована.

После суммирования с ограничением midi поток направляется в блок анализатора
диссонансов аккорда, где в зависимости от ситуации производится то или иное
панорамирование каждого отдельного голоса аккорда, т.е. распределение его по
правому и/или левому стереоканалу звука.

Панорамированный midi поток посылается на устройство "MIDI Output Device",
которое и синтезирует звуковой сигнал.

2. Органы управления.


"General Midi Instrument" инструмент, тембром которого будут звучать все
 голоса аккорда. 


"Transposition" высота внешних нот изменяется на данное число полутонов.


"Auto rePress keys" в нажатом состоянии этой кнопки при добавлении каждого
 нового голоса в аккорд производится пере-извлечение всех остальных ранее
 возникших голосов аккорда, при этом улучшается "стабильность" панорамы
 одного и того же аккорда, взятого с разным порядком его голосов.


"Panorame position's number" количество точек панорамы, используемое при
 панорамировании аккорда.
"1 Point" соответствует одной точке в центре панорамы (монофоническое звучание).
"2 Point" соответствует двум точкам - по краям панорамы (левому и правому).
"3 Point" соответствует трём точкам: одной в центре и двум по краям панорамы.


"Voices panorame sort mode" метод сортировки голосов по точкам панорамы.
"DOn't sort" сортировка не производится, панорама аккорда "нестабильна".
"Increase Sort" более низкие по высоте голоса преимущественно направляются в
 левый канал панорамы, более высокие - в правый, а промежуточные - в центр,
 т.о. панорама одинаковых аккордов становится более "стабильной".
"Decrease sort" противоположный вариант сортировки.


"Dissonances analysis mode" метод принятия решения о панорамировании аккорда.
"Average of all dissonances" сумма диссонансов всевозможных попарных интервалов
 аккорда делится на N (количество голосов аккорда) и если это число (выводимое
 в индикаторе "Aver:") не меньше чем "Dissonance threshold for N voices", то
 голоса аккорда панорамируются по выбранному количеству точек панорамы, иначе
 все голоса выводятся по центру панорамы.
"Maximum of all dissonances" если максимальный диссонанс аккорда (выводимый в
 индикаторе "Max:") не меньше чем указанный выше порог, аккорд панорамируется.
 Идея состоит в том, чтобы при помощи панорамирования уменьшать диссонантность
 не всех аккордов, а только тех, у которых диссонанс достаточно велик.

"Dissonance threshold for 2...6 voices" см. регуляторы "2v","3v","4v","5v","6v"
 изменяемые индивидуально диссонансные пороги для аккорда из 2...6 голосов.
"All dissonance thresholds" общий регулятор всех вышеперечисленных порогов.


"Midi number of zero note" индикатор midi номера нулевой относительной ноты
 аккорда. Число, которое нужно добавить к относительному номеру ноты аккорда
 чтобы получить абсолютный midi номер ноты.


"Dichotic total dissonance" сумма диссонансов всех попарных интервалов аккорда
 с учётом принятой модели дихотического восприятия, в которой считается что
 интервал между крайними точками панорамы не даёт диссонанса, а интервал между
 центром панорамы и любым краем даёт половину обычного диссонанса.


"Swap left/right speakers" перестановка местами левого и правого канала звука.


"Left:" относительные номера нот голосов аккорда на левом краю панорамы.
"Mid:", "Right:" то же для центра и правого края панорамы.


"Dissonance[interval] = 0[0], 22[1], 16[2] ..." массив уровней диссонанса для
 каждого интервала (в полутонах), это содержимое файла "drfile.txt".


Блок внутреннего генератора аккордов.


"Edit accord generator data" при нажатии на эту кнопку нажатия клавиш кейборда
 ПК интерпретируются как команды редактирования параметров генератора, а не как
 "горячие клавиши".


"Number of voices" количество голосов аккорда.

"Accord's number" порядковый номер варианта аккорда.

"NvA accord notes: a,b,c" идентификатор аккорда (N число голосов, A порядковый
 номер варианта аккорда): относительные номера нот голосов аккорда.



"Max accord's interval" максимальный интервал в полутонах от верхнего до нижнего
 голоса аккорда, используемый для вычисления количества аккордов.

"Max accord's number" индикатор количества аккордов с заданным числом голосов,
 содержащихся в пределах заданного максимального интервала.


"Midi number of zero note" midi номер нулевой относительной ноты аккорда.


"Generate accord" кнопка для генерации midi аккорда.


"Number in accords chain" кнопка для копирования в генератор параметров аккорда
 из файла цепочки аккордов "accordsfile.txt", порядковый номер этого аккорда в
 цепочке аккордов определяется числом в соседнем поле редактирования.


3. Горячие клавиши.


Insert  - генерация аккорда ("Generate accord")

1,2,3   - количество точек панорамы ("Panorame position's number")

F1...F8 - несколько разных инструментов ("General Midi Instrument")


4. Автоматически загружаемые файлы.

Это текстовые файлы в ANSI или Unicode кодировке с набором чисел.
Числа должны отделяться друг от друга хотя бы одним пробелом или новой строкой.

"accordsfile.txt" - файл цепочки аккордов, первое число это число голосов, затем
 идут числа номеров аккордов, аккорд номер 0 это запасной признак конца цепочки.


"drfile.txt" - файл с таблицей диссонансов "Dissonance[interval]", числа идут по
 порядку интервалов, начиная с нулевого.

"maxdrfile.txt" - файл с таблицей диссонансных порогов для аккорда из V голосов,
 где V=0,1,2,3,4,5,6 - см. "Dissonance threshold for 2...6 voices".


